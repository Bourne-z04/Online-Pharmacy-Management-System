一、软件结构树形图

1. 登录验证子系统

登录验证
├── C端登录验证
│   ├── 隐私协议管理
│   │   ├── 协议展示
│   │   └── 同意状态记录
│   │       └── 协议数据持久化
│   ├── 微信授权登录
│   │   ├── OpenID获取
│   │   │   └── 微信API调用
│   │   └── 用户ID绑定
│   │       └── 绑定关系存储
│   └── 登录状态控制
│       ├── 权限隔离
│       │   └── 访问权限判定
│       └── 访问拦截
│           └── 未授权拦截处理
└── B端登录验证
    ├── 账号注册
    │   ├── 唯一性校验
    │   │   └── 账号重复性检查
    │   └── 密码加密存储
    │       └── 密码哈希处理
    ├── 账号登录
    │   ├── 凭证验证
    │   │   └── 密码匹配验证
    │   └── 会话管理
    │       └── Token生成与分发
    └── 密码修改
        ├── 原密码验证
        │   └── 原密码正确性校验
        └── 新密码更新
            └── 密码更新执行
2. 用户信息管理子系统

用户信息管理
├── C端个人信息管理
│   ├── 个人中心展示
│   │   ├── 用户信息加载
│   │   │   └── 用户数据查询
│   │   └── 功能模块导航
│   │       └── 导航数据组装
│   ├── 基础信息编辑
│   │   ├── 昵称校验
│   │   │   ├── 长度校验
│   │   │   └── 字符类型校验
│   │   ├── 生日范围校验
│   │   │   ├── 最小日期校验
│   │   │   └── 最大日期校验
│   │   └── 数据保存
│   │       └── 个人信息更新
│   ├── 头像上传管理
│   │   ├── 图片格式校验
│   │   ├── 大小限制检查
│   │   ├── 网络状态检测
│   │   └── 图片缩放处理
│   │       └── 个人信息更新
│   └── 收货地址管理
│       ├── 地址列表维护
│       │   └── 地址列表查询
│       ├── 地址有效性校验
│       │   └── 门牌号必填校验
│       ├── 上限数量控制
│       │   └── 数量上限判定
│       └── 默认地址设置
│           └── 个人信息更新
└── B端用户信息管理
    ├── 工作人员信息维护
    │   └── 员工数据维护
    ├── 角色权限管理
    │   └── 权限配置管理
    └── 账号状态管理
        └── 状态变更控制
3. 商品浏览与商品管理子系统

商品浏览与商品管理
├── C端商品浏览
│   ├── 分类导航
│   │   ├── 分类加载
│   │   │   └── 分类数据获取
│   │   └── 分类切换
│   │       └── 切换响应处理
│   ├── 商品列表展示
│   │   ├── 分页加载
│   │   │   └── 分页数据查询
│   │   ├── 骨架屏显示
│   │   │   └── 加载状态渲染
│   │   └── 网络错误处理
│   │       └── 错误界面渲染
│   ├── 智能搜索
│   │   ├── 关键词模糊匹配
│   │   │   └── 模糊查询执行
│   │   ├── 拼音联想
│   │   │   └── 联想词生成
│   │   ├── 历史记录管理
│   │   │   └── 历史记录存取
│   │   └── 空结果推荐
│   │       └── 推荐商品获取
│   ├── 详情页展示
│   │   ├── 商品信息加载
│   │   │   └── 详情数据查询
│   │   ├── 下架状态检测
│   │   │   └── 状态码判定
│   │   └── 内容模块渲染
│   │       └── 超长内容折叠
│   ├── 详情页导航
│   │   ├── 客服联系
│   │   │   └── 联系方式获取
│   │   ├── 购物车加入
│   │   │   └── 加入请求转发
│   │   └── 购买控制
│   │       └── 购买权限校验
│   └── 订单发起
│       ├── 数量选择
│       │   └── 数量范围限制
│       ├── 库存实时校验
│       │   └── 库存充足性检查
│       └── 有效性检查
│           └── 商品下架检测
└── B端商品管理
    ├── 商品信息维护
    │   ├── 新增商品
    │   │   └── 商品数据写入
    │   ├── 编辑商品
    │   │   └── 商品数据更新
    │   └── 删除商品
    │       └── 商品数据删除
    ├── 状态管理
    │   ├── 上架审核
    │   │   └── 完整性校验
    │   ├── 下架处理
    │   │   └── 状态变更执行
    │   └── 核心属性锁定
    │       └── 属性锁定控制
    └── 库存同步控制
        ├── 医药管理系统对接
        │   └── 接口调用管理
        └── 库存数据同步
            └── 同步数据处理
4. 购物车管理子系统

购物车管理
├── 购物车数据管理
│   ├── 数据持久化存储
│   │   └── 数据写入执行
│   ├── 商品状态同步
│   │   └── 状态同步执行
│   └── 价格实时计算
│       └── 总价计算执行
├── 商品展示控制
│   ├── 商品列表加载
│   │   └── 列表数据查询
│   ├── 处方药标识
│   │   └── 标识渲染
│   └── 合计金额更新
│       └── 金额更新渲染
├── 数量修改处理
│   ├── 数量输入校验
│   │   └── 输入合法性检查
│   ├── 库存实时检查
│   │   └── 库存余量查询
│   └── 界面同步更新
│       └── 界面刷新执行
├── 批量操作管理
│   ├── 批量选择
│   │   └── 选择状态记录
│   ├── 删除验证
│   │   └── 已勾选检查
│   └── 删除执行
│       └── 删除操作执行
└── 结算流程控制
    ├── 商品类型识别
    │   └── 类型判定逻辑
    ├── 普通结算跳转
    │   └── 跳转触发
    └── 处方开方跳转
        └── 跳转触发
5. 订单结算与订单处理子系统

订单结算与订单处理
├── C端订单结算
│   ├── 结算页初始化
│   │   ├── 商品清单加载
│   │   │   └── 清单数据查询
│   │   └── 地址信息获取
│   │       └── 地址数据查询
│   ├── 收货地址管理
│   │   ├── 默认地址选择
│   │   │   └── 默认地址获取
│   │   ├── 地址有效性检查
│   │   │   └── 地址存在性校验
│   │   └── 无地址拦截
│   │       └── 拦截跳转执行
│   ├── 配送方式选择
│   │   ├── 方式切换
│   │   │   └── 切换处理逻辑
│   │   ├── 时段选择
│   │   │   └── 时段数据加载
│   │   └── 门店列表管理
│   │       └── 门店数据加载
│   ├── 金额计算引擎
│   │   ├── 商品总价计算
│   │   │   └── 价格汇总逻辑
│   │   ├── 运费计算
│   │   │   └── 运费规则应用
│   │   ├── 优惠计算
│   │   │   └── 优惠规则应用
│   │   └── 应付金额汇总
│   │       └── 金额合并计算
│   ├── 支付流程控制
│   │   ├── 支付唤起
│   │   │   └── 支付SDK调用
│   │   ├── 支付状态轮询
│   │   │   └── 轮询请求发送
│   │   ├── 超时处理
│   │   │   └── 超时关闭执行
│   │   └── 库存锁定
│   │       └── 库存锁定指令
│   └── 订单取消管理
│       ├── 取消触发
│       │   └── 取消确认获取
│       ├── 状态校验
│       │   └── 支付状态检查
│       └── 取消执行
│           └── 取消操作执行
└── B端订单处理
    ├── 订单工作台
    │   ├── 状态筛选
    │   │   └── 筛选条件应用
    │   └── 订单列表加载
    │       └── 列表数据查询
    ├── 发货处理
    │   ├── 发货触发
    │   │   └── 发货指令接收
    │   ├── 配送方式选择
    │   │   └── 配送选项加载
    │   ├── 即时配送API调用
    │   │   └── API请求发送
    │   └── 发货结果确认
    │       └── 结果处理逻辑
    └── 售后处理
        ├── 售后申请接收
        │   └── 申请数据获取
        ├── 审核操作
        │   └── 审核决定处理
        ├── 拒绝原因管理
        │   └── 原因记录
        └── 超时自动处理
            └── 超时判定执行
6. 处方服务子系统

处方服务
├── 患者信息管理
│   ├── 实名信息录入
│   │   ├── 姓名校验
│   │   │   └── 姓名格式检查
│   │   └── 身份证号验证
│   │       └── 身份证格式校验
│   ├── 病情信息录入
│   │   ├── 疾病描述
│   │   │   └── 描述文本接收
│   │   └── 体重范围校验
│   │       └── 体重数值校验
│   ├── 复诊凭证上传
│   │   ├── 图片数量限制
│   │   │   └── 数量上限检查
│   │   ├── 单张大小校验
│   │   │   └── 文件大小检查
│   │   └── 格式检查
│   │       └── 格式合法性检查
│   └── 协议确认
│       └── 协议同意状态记录
├── 在线问诊服务
│   ├── 医生匹配
│   │   └── 科室匹配逻辑
│   ├── 问诊会话管理
│   │   ├── 图文消息收发
│   │   │   └── 消息传递处理
│   │   ├── 会话时长控制
│   │   │   └── 10分钟计时
│   │   └── 记录自动保存
│   │       └── 会话存储执行
│   └── 医生状态处理
│       ├── 在线状态检测
│       │   └── 状态查询执行
│       ├── 离线等待提示
│       │   └── 预计时间计算
│       └── 排队管理
│           └── 排队队列维护
└── 处方管理
    ├── 处方开具
    │   ├── 开具时限控制
    │   │   └── 5分钟计时
    │   └── 超时自动关闭
    │       └── 超时关闭执行
    ├── 处方存储
    │   ├── 处方图片保存
    │   │   └── 图片存储执行
    │   └── 审核意见记录
    │       └── 意见文本存储
    └── 处方推送
        └── 推送触发执行
7. 配送服务子系统

配送服务
├── C端物流查询
│   ├── 配送状态展示
│   │   ├── 节点信息加载
│   │   │   └── 节点数据查询
│   │   └── 进度更新
│   │       └── 界面刷新执行
│   ├── 实时轮询
│   │   └── 定时查询触发
│   └── 服务通知推送
│       └── 微信通知调用
└── B端发货配送
    ├── 发货指令处理
    │   ├── 发货确认
    │   │   └── 发货指令验证
    │   └── 配送单生成
    │       └── 配送单创建执行
    ├── 配送平台对接
    │   ├── 即时配送API调用
    │   │   └── API请求构造
    │   ├── 平台选择
    │   │   └── 平台选择逻辑
    │   └── 推送结果处理
    │       └── 结果反馈处理
    └── 配送状态同步
        ├── 回调接收
        │   └── 回调数据接收
        ├── 状态更新
        │   └── 状态数据更新
        └── 异常处理
            └── 异常逻辑处理
8. 售后服务子系统

售后服务
├── 售后申请管理
│   ├── 申请入口控制
│   │   └── 入口权限检查
│   ├── 状态校验
│   │   └── 订单状态验证
│   ├── 凭证上传
│   │   ├── 图片数量限制
│   │   │   └── 数量检查执行
│   │   └── 单张大小校验
│   │       └── 大小检查执行
│   └── 原因选择
│       └── 原因选项记录
└── 售后审核处理
    ├── 申请列表加载
    │   └── 售后数据查询
    ├── 审核操作
    │   ├── 同意处理
    │   │   └── 同意执行
    │   └── 拒绝处理
    │       └── 拒绝执行
    ├── 拒绝原因管理
    │   └── 原因文本记录
    └── 超时自动处理
        └── 超时判定逻辑
9. 统计分析子系统

统计分析
├── 销售报表生成
│   ├── 时间范围选择
│   │   └── 范围参数解析
│   ├── 指标计算
│   │   ├── 销售额统计
│   │   │   └── 金额累加计算
│   │   ├── 订单量统计
│   │   │   └── 订单计数
│   │   ├── 客单价计算
│   │   │   └── 平均值计算
│   │   └── 退单率计算
│   │       └── 比率计算逻辑
│   └── 报表导出
│       ├── Excel格式
│       │   └── Excel文件生成
│       └── PDF格式
│           └── PDF文件生成
├── 业绩统计
│   ├── 销售员业绩计算
│   │   └── 业绩数据汇总
│   ├── 排行榜生成
│   │   └── 排名计算逻辑
│   └── 提成金额计算
│       └── 提成规则应用
└── 商品销售统计
    ├── TOP100排行榜
    │   └── 销量排序计算
    ├── 类别占比分析
    │   ├── 饼状图生成
    │   │   └── 饼图数据计算
    │   └── 柱状图生成
    │       └── 柱状图数据计算
    └── 筛选条件处理
        └── 条件应用逻辑

二、数据/控制信号流向
1. 登录验证子系统

隐私协议同意标志：从 协议展示 到 同意状态记录
协议记录数据：从 同意状态记录 到 协议数据持久化

微信授权码：从 OpenID获取 到 微信API调用
OpenID：从 微信API调用 到 用户ID绑定
用户绑定关系：从 用户ID绑定 到 绑定关系存储

访问权限校验请求：从 登录状态控制 到 访问权限判定
权限校验结果：从 访问权限判定 到 权限隔离
未授权拦截指令：从 访问权限判定 到 未授权拦截处理
拦截处理结果：从 未授权拦截处理 到 登录状态控制

注册表单数据：从 账号注册 到 唯一性校验
重复性校验结果：从 唯一性校验 到 账号重复性检查
加密后密码：从 密码加密存储 到 密码哈希处理

登录凭证：从 账号登录 到 凭证验证
密码匹配结果：从 凭证验证 到 密码匹配验证
会话Token：从 会话管理 到 Token生成与分发

原密码验证请求：从 密码修改 到 原密码验证
原密码校验结果：从 原密码验证 到 原密码正确性校验
新密码数据：从 新密码更新 到 密码更新执行

2. 用户信息管理子系统

用户信息请求：从 个人中心展示 到 用户信息加载
用户数据：从 用户信息加载 到 用户数据查询
导航模块数据：从 功能模块导航 到 导航数据组装

昵称输入数据：从 基础信息编辑 到 昵称校验
长度校验结果：从 昵称校验 到 长度校验
字符校验结果：从 昵称校验 到 字符类型校验

生日输入数据：从 基础信息编辑 到 生日范围校验
最小日期校验结果：从 生日范围校验 到 最小日期校验
最大日期校验结果：从 生日范围校验 到 最大日期校验

个人信息更新数据：从 数据保存 到 个人信息更新

上传图片：从 头像上传管理 到 图片格式校验
图片大小检查结果：从 大小限制检查 到 图片缩放处理
缩放后图片：从 图片缩放处理 到 个人信息更新

地址列表请求：从 地址列表维护 到 地址列表查询
地址有效性校验结果：从 地址有效性校验 到 门牌号必填校验
数量限制结果：从 上限数量控制 到 数量上限判定
默认地址更新数据：从 默认地址设置 到 个人信息更新

员工信息输入：从 工作人员信息维护 到 员工数据维护
权限配置数据：从 角色权限管理 到 权限配置管理
账号状态变更：从 账号状态管理 到 状态变更控制

3. 商品浏览与商品管理子系统

分类加载请求：从 分类导航 到 分类数据获取
分类切换事件：从 分类切换 到 切换响应处理

分页数据请求：从 分页加载 到 分页数据查询
加载状态信号：从 骨架屏显示 到 加载状态渲染
错误提示状态：从 网络错误处理 到 错误界面渲染

搜索关键词：从 关键词模糊匹配 到 模糊查询执行
拼音输入：从 拼音联想 到 联想词生成
历史记录操作：从 历史记录管理 到 历史记录存取
推荐请求：从 空结果推荐 到 推荐商品获取

商品详情请求：从 商品信息加载 到 详情数据查询
下架状态码：从 下架状态检测 到 状态码判定
内容模块数据：从 内容模块渲染 到 超长内容折叠

客服请求：从 客服联系 到 联系方式获取
加入购物车指令：从 购物车加入 到 加入请求转发
购买权限校验数据：从 购买控制 到 购买权限校验

数量数据：从 数量选择 到 数量范围限制
库存校验请求：从 库存实时校验 到 库存充足性检查
商品有效性结果：从 有效性检查 到 商品下架检测

商品新增数据：从 新增商品 到 商品数据写入
编辑商品数据：从 编辑商品 到 商品数据更新
删除商品数据：从 删除商品 到 商品数据删除

上架审核请求：从 上架审核 到 完整性校验
下架指令：从 下架处理 到 状态变更执行
属性锁定指令：从 核心属性锁定 到 属性锁定控制

库存对接请求：从 医药管理系统对接 到 接口调用管理
同步数据：从 库存数据同步 到 同步数据处理

4. 购物车管理子系统

购物车存储数据：从 数据持久化存储 到 数据写入执行
商品状态数据：从 商品状态同步 到 状态同步执行
价格计算请求：从 价格实时计算 到 总价计算执行

商品列表请求：从 商品列表加载 到 列表数据查询
处方标识数据：从 处方药标识 到 标识渲染
金额更新数据：从 合计金额更新 到 金额更新渲染

数量输入数据：从 数量输入校验 到 输入合法性检查
库存检查数据：从 库存实时检查 到 库存余量查询
界面刷新指令：从 界面同步更新 到 界面刷新执行

批量选择状态：从 批量选择 到 选择状态记录
删除校验数据：从 删除验证 到 已勾选检查
删除执行指令：从 删除执行 到 删除操作执行

商品类型识别数据：从 商品类型识别 到 类型判定逻辑
普通结算跳转信号：从 普通结算跳转 到 跳转触发
处方跳转信号：从 处方开方跳转 到 跳转触发

5. 订单结算与订单处理子系统

结算清单请求：从 商品清单加载 到 清单数据查询
地址加载请求：从 地址信息获取 到 地址数据查询

默认地址请求：从 默认地址选择 到 默认地址获取
地址有效性校验结果：从 地址有效性检查 到 地址存在性校验
无地址跳转信号：从 无地址拦截 到 拦截跳转执行

配送方式切换事件：从 方式切换 到 切换处理逻辑
时段数据请求：从 时段选择 到 时段数据加载
门店数据请求：从 门店列表管理 到 门店数据加载

价格汇总数据：从 商品总价计算 到 价格汇总逻辑
运费计算数据：从 运费计算 到 运费规则应用
优惠计算数据：从 优惠计算 到 优惠规则应用
金额汇总结果：从 应付金额汇总 到 金额合并计算

支付调用请求：从 支付唤起 到 支付SDK调用
支付轮询请求：从 支付状态轮询 到 轮询请求发送
支付超时信号：从 超时处理 到 超时关闭执行
库存锁定指令：从 库存锁定 到 库存锁定指令

取消确认数据：从 取消触发 到 取消确认获取
订单状态校验结果：从 状态校验 到 支付状态检查
取消执行指令：从 取消执行 到 取消操作执行

订单状态筛选条件：从 状态筛选 到 筛选条件应用
订单列表数据：从 订单列表加载 到 列表数据查询

发货指令：从 发货触发 到 发货指令接收
配送方式数据：从 配送方式选择 到 配送选项加载
配送API请求：从 即时配送API调用 到 API请求发送
发货确认数据：从 发货结果确认 到 结果处理逻辑

售后申请数据：从 售后申请接收 到 申请数据获取
审核操作结果：从 审核操作 到 审核决定处理
拒绝原因：从 拒绝原因管理 到 原因记录
自动处理指令：从 超时自动处理 到 超时判定执行

6. 处方服务子系统

实名录入数据：从 实名信息录入 到 姓名校验
身份证校验结果：从 身份证号验证 到 身份证格式校验

病情描述数据：从 疾病描述 到 描述文本接收
体重校验数据：从 体重范围校验 到 体重数值校验

上传图片数据：从 复诊凭证上传 到 数量上限检查
图片大小校验结果：从 单张大小校验 到 文件大小检查
格式校验结果：从 格式检查 到 格式合法性检查

协议确认状态：从 协议确认 到 协议同意状态记录

医生匹配请求：从 医生匹配 到 科室匹配逻辑

消息数据：从 图文消息收发 到 消息传递处理
会话时长信号：从 会话时长控制 到 10分钟计时
自动保存指令：从 记录自动保存 到 会话存储执行

在线状态查询：从 在线状态检测 到 状态查询执行
离线提示数据：从 离线等待提示 到 预计时间计算
排队管理数据：从 排队管理 到 排队队列维护

开方时限信号：从 开具时限控制 到 5分钟计时
超时关闭执行：从 超时自动关闭 到 超时关闭执行

处方图片数据：从 处方图片保存 到 图片存储执行
审核意见数据：从 审核意见记录 到 意见文本存储

推送指令：从 处方推送 到 推送触发执行

7. 配送服务子系统

配送节点请求：从 节点信息加载 到 节点数据查询
进度更新信号：从 进度更新 到 界面刷新执行
轮询触发信号：从 实时轮询 到 定时查询触发
通知推送指令：从 服务通知推送 到 微信通知调用

发货确认数据：从 发货确认 到 发货指令验证
配送单数据：从 配送单生成 到 配送单创建执行

配送API构造数据：从 即时配送API调用 到 API请求构造
平台选择数据：从 平台选择 到 平台选择逻辑
推送处理结果：从 推送结果处理 到 结果反馈处理

回调数据：从 回调接收 到 回调数据接收
状态更新数据：从 状态更新 到 状态数据更新
异常处理信号：从 异常处理 到 异常逻辑处理

8. 售后服务子系统

入口权限验证：从 申请入口控制 到 入口权限检查
订单状态校验请求：从 状态校验 到 订单状态验证

图片数量数据：从 图片数量限制 到 数量检查执行
图片大小数据：从 单张大小校验 到 大小检查执行
原因记录数据：从 原因选择 到 原因选项记录

售后列表请求：从 申请列表加载 到 售后数据查询
同意操作数据：从 同意处理 到 同意执行
拒绝操作数据：从 拒绝处理 到 拒绝执行
拒绝原因数据：从 拒绝原因管理 到 原因文本记录
自动处理信号：从 超时自动处理 到 超时判定逻辑

9. 统计分析子系统

时间范围参数：从 时间范围选择 到 范围参数解析

销售额统计数据：从 销售额统计 到 金额累加计算
订单量统计数据：从 订单量统计 到 订单计数
客单价数据：从 客单价计算 到 平均值计算
退单率数据：从 退单率计算 到 比率计算逻辑

Excel导出数据：从 Excel格式 到 Excel文件生成
PDF导出数据：从 PDF格式 到 PDF文件生成

业绩数据输入：从 销售员业绩计算 到 业绩数据汇总
排行榜请求：从 排行榜生成 到 排名计算逻辑
提成金额数据：从 提成金额计算 到 提成规则应用

销量排序数据：从 TOP100排行榜 到 销量排序计算
类别占比数据：从 饼状图生成 到 饼图数据计算
柱状图数据：从 柱状图生成 到 柱状图数据计算
筛选条件：从 筛选条件处理 到 条件应用逻辑