E-R图（实体-关系图）（需转化为为画图版（Graphviz、PlantUML、PowerPoint图形、Visio结构图））

一、实体及其属性
实体1：C端用户

属性：用户ID、微信OpenID、手机号、昵称、性别、生日、注册时间、默认地址ID
说明：小程序购药、问诊的消费者。

实体2：B端用户

属性：账号ID、账号名、密码哈希、角色、注册时间、所属门店ID
说明：用于后台管理的店员、店长或管理员。

实体3：收货地址

属性：地址ID、用户ID、收件人姓名、手机号、省市区、详细地址、是否默认、创建时间。

实体4：商品

属性：商品ID、商品名称、商品类型、规格、主图URL、价格、上架状态、创建时间、更新时间。

实体5：库存

属性：库存ID、商品ID、当前库存量、锁定库存量、同步时间。

实体6：购物车项

属性：购物车项ID、用户ID、商品ID、数量、加入时间。

实体7：订单

属性：订单ID、用户ID、地址ID、订单金额、配送方式、订单状态、创建时间、支付时间、关闭时间。

实体8：订单明细

属性：明细ID、订单ID、商品ID、数量、单价、小计金额。

实体9：支付记录

属性：支付ID、订单ID、支付流水号、支付金额、支付方式、支付状态、创建时间。

实体10：物流记录

属性：物流ID、订单ID、配送平台、骑手姓名、骑手手机、配送状态、轨迹更新时间。

实体11：处方信息

属性：处方ID、订单ID、医生ID、处方图片URL、审核状态、开具时间。

实体12：患者信息

属性：患者ID、用户ID、姓名、身份证号、性别、年龄、体重、疾病描述、复诊证明URL。

实体13：问诊记录

属性：问诊ID、患者ID、医生ID、开始时间、结束时间、聊天存档URL、问诊状态。

实体14：售后申请

属性：售后ID、订单ID、用户ID、申请类型、申请原因、凭证图片URL、处理状态、提交时间。

实体15：门店

属性：门店ID、名称、门店地址、营业状态、联系方式。

二、实体之间的关系
一、用户相关关系
关系1：C端用户 与 收货地址

关系类型：一对多
关系描述：每个用户可以拥有多条收货地址。

关系2：C端用户 与 购物车项

关系类型：一对多
关系描述：用户可以向购物车添加多种商品。

关系3：C端用户 与 订单

关系类型：一对多
关系描述：用户可以产生多个订单。

关系4：C端用户 与 患者信息

关系类型：一对多
关系描述：一个用户可以为多个家属或本人提交患者信息。

二、订单链路关系
关系5：订单 与 订单明细

关系类型：一对多
关系描述：一个订单由多个订单商品明细组成。

关系6：订单 与 支付记录

关系类型：一对一
关系描述：一个订单对应一条唯一的支付记录。

关系7：订单 与 物流记录

关系类型：一对一
关系描述：订单在配送时会生成唯一物流跟踪记录。

关系8：订单 与 处方信息

关系类型：一对一
关系描述：若含有处方药，该订单会生成一条对应处方记录。

关系9：订单 与 售后申请

关系类型：一对多
关系描述：订单可产生一次或多次售后申请（如退款、退货）。

三、问诊链路关系
关系10：患者信息 与 问诊记录

关系类型：一对多
关系描述：患者可以发起多次图文问诊。

关系11：问诊记录 与 处方信息

关系类型：一对一
关系描述：每次问诊若诊断通过将生成一条处方。

四、后台管理关系
关系12：B端用户 与 门店

关系类型：多对一
关系描述：多个后台用户可属于同一家门店。

关系13：商品 与 库存

关系类型：一对一
关系描述：每个商品对应唯一库存记录。

关系14：B端用户 与 商品管理操作

关系类型：一对多
关系描述：后台用户可以新增、编辑或上下架多个商品。

关系15：B端用户 与 订单处理

关系类型：一对多
关系描述：后台用户可负责多个订单的发货或售后处理。